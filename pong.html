<html>
    <canvas id="gameCanvas" width="600" height="600"></canvas>
<script>
    var canvas;
    var canvasContext;
    var ballX = 50;
    var ballY = 50;
    var ballSpeedX = 10;
    var ballSpeedY = 4;
    
    var pad1Y = 250;
    var pad2Y = 250;
    const PADDLE_HEIGHT = 100;
    const PADDLE_THICKNESS = 11;

    var p1Score = 0;
    var p2Score = 0;

function calcMousePos(evt){ //function for finding the cursor position
    var rect = canvas.getBoundingClientRect();
    var root = document.documentElement;
    var mouseX = evt.clientX - rect.left - root.scrollLeft;
    var mouseY = evt.clientY - rect.top - root.scrollTop;
    return{
        x: mouseX,
        y: mouseY
    };
}

window.onload = function() {
    console.log("Hello");
    canvas = document.getElementById('gameCanvas');
    canvasContext = canvas.getContext('2d');

    var fPS = 30; //frames per second
    setInterval(function(){moveEverything(),drawEverything();}, 1000/fPS);

    canvas.addEventListener('mousemove', function(evt){
        var mousePos = calcMousePos(evt);
        pad1Y = mousePos.y-(PADDLE_HEIGHT/2);
    });
   
}

function compMove(){ // for moving the right paddle
    var pad2YCenter = pad2Y +(PADDLE_HEIGHT/2);
    if(pad2YCenter < ballY - 35){
        pad2Y+=8;
    }else if(pad2YCenter > ballY + 35){
        pad2Y-=8;
    }
}

function moveEverything(){
    ballX+=ballSpeedX; //move the ball
    /*if (ballX > gameCanvas.width -10 || ballX < 0 ){ //if the ball hits the edge of the canvas then reverse it's direction
        ballSpeedX = -ballSpeedX;
    }
    */
    compMove();
    if (ballX <= PADDLE_THICKNESS) { //check if the ball hits the left(yellow) paddle
        if (ballY > pad1Y && ballY < pad1Y + PADDLE_HEIGHT) {
            ballSpeedX = -ballSpeedX;
        }else{
            p2Score++;
            ballReset();
        }
    }

    if (ballX >= canvas.width-PADDLE_THICKNESS) { //check if the ball hits the right(blue) paddle
        if (ballY > pad2Y && ballY < pad2Y + PADDLE_HEIGHT) {
            ballSpeedX = -ballSpeedX;
        }else{
            p1Score++;
            ballReset();
        }
    }

    /*if (ballX <= 0){ //reset the ball if it misses a paddle
        ballReset();
    }
    if (ballX >= canvas.width){  //reset the ball if it misses a paddle
        ballReset();
    }*/

    ballY+=ballSpeedY;//move the ball 
    if (ballY > gameCanvas.width -10 || ballY < 0 ){ //if the ball hits the edge of the canvas then reverse it's direction
        ballSpeedY = -ballSpeedY;
    }
}

function drawEverything(){
    
    //canvasContext.fillStyle = 'black';
    colourRect(0,0, canvas.width, canvas.height, 'black'); //creates black background
    
    
    colourCircle(ballX,ballY,10, 'red');//make the ball
    //colourRect(ballX, 100,10,10, 'red'); //red ball

    //canvasContext.fillStyle = "yellow";
    colourRect(1,pad1Y,PADDLE_THICKNESS,PADDLE_HEIGHT, 'yellow'); //yellow PLAYERS paddle
    canvasContext.fillText("SCORE: "+p1Score, 100, 100);
    
    colourRect(canvas.width-PADDLE_THICKNESS,pad2Y,PADDLE_THICKNESS,PADDLE_HEIGHT, 'blue');//blue paddle

    canvasContext.fillText("SCORE: "+p2Score, canvas.width - 100,100);
}

function colourRect(leftX,topY, width,height, drawColour){ //funciton for drawing rectangles
    canvasContext.fillStyle = drawColour;
    canvasContext.fillRect(leftX,topY,width,height);
}
function colourCircle(centreX, centreY, radius, drawColour){
    canvasContext.fillStyle = drawColour;
    canvasContext.beginPath();
    canvasContext.arc(centreX, centreY, radius, 0,Math.PI*2, true);
    canvasContext.fill();
}

function ballReset(){
    ballSpeedX = -ballSpeedX;
    ballX = canvas.width/2;
    ballY = canvas.height/2;
}

</script>
</html>